12:53:20 INFO Training with 
{   'attention_mode': 'label',
    'batch_size': 8,
    'best_model_path': None,
    'bidirectional': 1,
    'd_a': 512,
    'dropout': 0.3,
    'embedding_file': 'data/embeddings/word2vec_sg0_100.model',
    'embedding_mode': 'word2vec',
    'embedding_size': 100,
    'exp_name': 'gcn_single_none',
    'hidden_size': 512,
    'joint_mode': 'hierarchical',
    'level_projection_size': 128,
    'loss_name': 'BCE',
    'lr': 0.001,
    'lr_scheduler_factor': 0.9,
    'lr_scheduler_patience': 5,
    'main_metric': 'micro_f1',
    'max_seq_length': 4000,
    'metric_level': 1,
    'min_seq_length': -1,
    'min_word_frequency': -1,
    'mode': 'static',
    'model': <class 'src.models.rnn.RNN'>,
    'multilabel': 1,
    'n_epoch': 50,
    'n_layers': 1,
    'optimiser': 'adamw',
    'patience': 5,
    'penalisation_coeff': 0.01,
    'problem_name': 'mimic-iii_2_50',
    'r': -1,
    'reduction': 'none',
    'resume_training': False,
    'rnn_model': 'LSTM',
    'save_best_model': 1,
    'save_results': 1,
    'save_results_on_train': False,
    'shuffle_data': 1,
    'use_last_hidden_state': 0,
    'use_lr_scheduler': 1,
    'use_regularisation': False,
    'weight_decay': 0}

12:53:21 INFO Preparing the vocab
12:53:21 INFO Saved vocab and data to files
12:53:21 INFO Using cuda:2
12:53:21 INFO # levels: 2
12:53:21 INFO # labels at level 0: 34
12:53:21 INFO # labels at level 1: 44
12:53:21 INFO 5.5.5
12:53:23 INFO Saved dataset path: cached_data/mimic-iii_2_50/797d28c2de5595caf911a3ed71f510b1.data.pkl
12:53:24 INFO 5 instances with 19926 tokens, Level_0 with 26 labels, Level_1 with 30 labels in the train dataset
12:53:24 INFO 5 instances with 20000 tokens, Level_0 with 20 labels, Level_1 with 25 labels in the valid dataset
12:53:24 INFO 5 instances with 20000 tokens, Level_0 with 20 labels, Level_1 with 25 labels in the test dataset
12:53:24 INFO Training epoch #1
12:53:24 INFO Learning rate at epoch #1: 0.001
12:53:24 INFO Loss on Train at epoch #1: 0.68886, micro_f1 on Valid: 0.225
12:53:24 INFO [NEW BEST] (level_1) micro_f1 on Valid set: 0.225
12:53:24 INFO Results on Valid set at epoch #1 with Averaged Loss 0.66134
12:53:24 INFO ======== Results at level_0 ========
12:53:24 INFO Results on Valid set at epoch #1 with Loss 0.67541: 
[MICRO]	accuracy: 0.14815	auc: 0.58132	precision: 0.24242	recall: 0.27586	f1: 0.25806	P@1: 0	P@5: 0	P@8: 0	P@10: 0	P@15: 0
[MACRO]	accuracy: 0.05588	auc: 0.53333	precision: 0.07059	recall: 0.13235	f1: 0.09207	P@1: 0.2	P@5: 0.24	P@8: 0.225	P@10: 0.2	P@15: 0.21333

12:53:24 INFO ======== Results at level_1 ========
12:53:24 INFO Results on Valid set at epoch #1 with Loss 0.64916: 
[MICRO]	accuracy: 0.12676	auc: 0.53746	precision: 0.18367	recall: 0.29032	f1: 0.225	P@1: 0	P@5: 0	P@8: 0	P@10: 0	P@15: 0
[MACRO]	accuracy: 0.04394	auc: 0.43333	precision: 0.04621	recall: 0.15152	f1: 0.07082	P@1: 0.2	P@5: 0.2	P@8: 0.225	P@10: 0.18	P@15: 0.2

12:53:24 INFO Training epoch #2
12:53:24 INFO Learning rate at epoch #2: 0.001
12:53:24 INFO Loss on Train at epoch #2: 0.65899, micro_f1 on Valid: 0.23333
12:53:24 INFO [NEW BEST] (level_1) micro_f1 on Valid set: 0.23333
12:53:24 INFO Results on Valid set at epoch #2 with Averaged Loss 0.63746
12:53:24 INFO ======== Results at level_0 ========
12:53:24 INFO Results on Valid set at epoch #2 with Loss 0.66075: 
[MICRO]	accuracy: 0.14583	auc: 0.55931	precision: 0.26923	recall: 0.24138	f1: 0.25455	P@1: 0	P@5: 0	P@8: 0	P@10: 0	P@15: 0
[MACRO]	accuracy: 0.04118	auc: 0.52917	precision: 0.04118	recall: 0.11765	f1: 0.061	P@1: 0.2	P@5: 0.28	P@8: 0.25	P@10: 0.2	P@15: 0.18667

12:53:24 INFO ======== Results at level_1 ========
12:53:25 INFO Results on Valid set at epoch #2 with Loss 0.61727: 
[MICRO]	accuracy: 0.13208	auc: 0.54702	precision: 0.24138	recall: 0.22581	f1: 0.23333	P@1: 0	P@5: 0	P@8: 0	P@10: 0	P@15: 0
[MACRO]	accuracy: 0.03485	auc: 0.46	precision: 0.03485	recall: 0.11364	f1: 0.05334	P@1: 0.2	P@5: 0.24	P@8: 0.25	P@10: 0.22	P@15: 0.2

12:53:25 INFO Training epoch #3
12:53:25 INFO Learning rate at epoch #3: 0.001
12:53:25 INFO Loss on Train at epoch #3: 0.62805, micro_f1 on Valid: 0.23077
12:53:25 INFO [CURRENT BEST] (level_1) micro_f1 on Valid set: 0.23333
12:53:25 INFO Early stopping: 1/6
12:53:25 INFO Training epoch #4
12:53:25 INFO Learning rate at epoch #4: 0.001
12:53:25 INFO Loss on Train at epoch #4: 0.59544, micro_f1 on Valid: 0.19608
12:53:25 INFO [CURRENT BEST] (level_1) micro_f1 on Valid set: 0.23333
12:53:25 INFO Early stopping: 2/6
12:53:25 INFO Training epoch #5
12:53:26 INFO Learning rate at epoch #5: 0.001
12:53:26 INFO Loss on Train at epoch #5: 0.55915, micro_f1 on Valid: 0.19608
12:53:26 INFO [CURRENT BEST] (level_1) micro_f1 on Valid set: 0.23333
12:53:26 INFO Early stopping: 3/6
12:53:26 INFO Training epoch #6
12:53:26 INFO Learning rate at epoch #6: 0.001
12:53:26 INFO Loss on Train at epoch #6: 0.51859, micro_f1 on Valid: 0.19608
12:53:26 INFO [CURRENT BEST] (level_1) micro_f1 on Valid set: 0.23333
12:53:26 INFO Early stopping: 4/6
12:53:26 INFO Training epoch #7
12:53:27 INFO Learning rate at epoch #7: 0.001
12:53:27 INFO Loss on Train at epoch #7: 0.47422, micro_f1 on Valid: 0.19608
12:53:27 INFO [CURRENT BEST] (level_1) micro_f1 on Valid set: 0.23333
12:53:27 INFO Early stopping: 5/6
12:53:27 INFO Training epoch #8
12:53:27 INFO Learning rate at epoch #8: 0.0009000000000000001
12:53:27 INFO Loss on Train at epoch #8: 0.42805, micro_f1 on Valid: 0.19608
12:53:27 INFO [CURRENT BEST] (level_1) micro_f1 on Valid set: 0.23333
12:53:27 INFO Early stopping: 6/6
12:53:27 WARNING Early stopped on Valid set!
12:53:27 INFO =================== BEST ===================
12:53:27 INFO Results on Valid set at epoch #2 with Averaged Loss 0.63746
12:53:27 INFO ======== Results at level_0 ========
12:53:27 INFO Results on Valid set at epoch #2 with Loss 0.66075: 
[MICRO]	accuracy: 0.14583	auc: 0.55931	precision: 0.26923	recall: 0.24138	f1: 0.25455	P@1: 0	P@5: 0	P@8: 0	P@10: 0	P@15: 0
[MACRO]	accuracy: 0.04118	auc: 0.52917	precision: 0.04118	recall: 0.11765	f1: 0.061	P@1: 0.2	P@5: 0.28	P@8: 0.25	P@10: 0.2	P@15: 0.18667

12:53:27 INFO ======== Results at level_1 ========
12:53:27 INFO Results on Valid set at epoch #2 with Loss 0.61727: 
[MICRO]	accuracy: 0.13208	auc: 0.54702	precision: 0.24138	recall: 0.22581	f1: 0.23333	P@1: 0	P@5: 0	P@8: 0	P@10: 0	P@15: 0
[MACRO]	accuracy: 0.03485	auc: 0.46	precision: 0.03485	recall: 0.11364	f1: 0.05334	P@1: 0.2	P@5: 0.24	P@8: 0.25	P@10: 0.22	P@15: 0.2

